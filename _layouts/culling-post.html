{% include header.html %}
    
{% include post-content.html %}

<img id="stone" src="/images/stone.png" style="display:none">

<script>

var canvas = document.getElementById("example1");
var stoneTex = document.getElementById("stone");
var dirtTex = document.getElementById("dirt");
var ctx = canvas.getContext("2d");

var sx = Math.floor((canvas.width) / 16);
var sy = Math.floor((canvas.height) / 16);

//setup the grid

var grid = 
[
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
];

var faceVisibility = 
[
	[1,1,1,1,1,1],
	[1,1,1,1,1,1],
	[1,1,1,1,1,1],
	[1,1,1,1,1,1],
	[1,1,1,1,1,1],
	[1,1,1,1,1,1]
]

for( var x = 0; x < 16; ++x ) {
	for( var y = 0; y < 16; ++y ) {
		drawCell(x,y,0);
	}
}

function drawCell(x,y, val) {
	var idx = x + y * 16;
	
	if(val == 1) {
		ctx.drawImage(stoneTex,x*sx+2,y*sy+2,sx-2,sy-2);

	}
	else if(val == 0) {
		ctx.fillStyle = "#FFFFFF";
		ctx.fillRect(x*sx + 2,y*sy + 2,sx -2,sy-2);
	}
	else
		alert("INVALID VALUE")
}


function drawVisiblityInfo() {



}

function updateVisibility() {
	drawVisiblityInfo();
}

function toggleCell(pos) {

	var x = Math.floor(pos.x / canvas.width * 16);
	var y = Math.floor(pos.y / canvas.height * 16);
	var idx = x + y * 16;
	
	var val = (grid[idx] == 0 ? 1 : 0);
	grid[idx] = val;

	updateVisibility();

	drawCell(x,y, val);
}

function getMousePos(canvas, evt) {
    var rect = canvas.getBoundingClientRect();
    return {
      x: evt.clientX - rect.left,
      y: evt.clientY - rect.top
    };
  }

canvas.addEventListener('click',
	function(event) {

		toggleCell( getMousePos(canvas, event) )
	}
	, false);

</script>

{% include footer.html %}